<html lang="en">
<head>
  <title>Refrigeration System</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1.0,maximum-scale=1.0"/>
</head>

<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://d3js.org/d3-selection-multi.v1.min.js"></script>
<script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/3.16.3/math.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/numeric/1.2.6/numeric.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>

<script type="text/x-mathjax-config"> MathJax.Hub.Config({ extensions: ["tex2jax.js"], jax: ["input/TeX","output/HTML-CSS"], tex2jax: { inlineMath: [["\(","\)"]] } }); </script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.18.0/TweenMax.min.js"></script>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

<link rel="stylesheet" href="stylesheet.css">

<script src="processes.js"></script>
<script src="graph.js"></script>
<script src="gas_law.js"></script>

<body>
  <div class = 'container-fluid text-center'>
    <div class = 'my-3'> <h4>Thermodynamic Processes<h4> </div>
    <div class = 'row'>
      <div class = 'col-md-6'>
        <div> <svg id = 'graph' width = '500px' height = '500px'></svg> </div>
        <div class = 'mx-5 text-justify' style = 'font-family: monospace;'> Use the black dots to change the values. <br>Click on the blue/red state points to change it's value </div>
      </div>

      <div class = 'col-md-6'>
        <p class = 'mt-5' style = 'font-family: monospace; font-size: 1.5em;'><b>Adiabatic Process</b></p>
        <p class = 'text-justify px-5' style = 'font-family: monospace;'>Adiabatic Processes are thermodynamic processes where there is no heat exchange between the system and the surroundings during the process.</p>

        <div class = 'row mt-4'>
          <div class = 'col-md-6'>
            <div class = 'card'>
              <div class = 'card-header'>State 1</div>
              <div class = 'card-body text-justify'>
                <div style = 'margin-left: 10%'>
                  <div> <span>(p:) </span> <input id = 's1_p' class = 's1_input' type = 'number' min = '0' max = '300' data = 'p'></input> (kPa) </div>
                  <div class = 'my-2'> <span>(v:) </span> <input id = 's1_v' class = 's1_input' type = 'number' min = '0' max = '1' step = '0.01' data = 'v'></input> (kg/m^3) </div>
                  <div> <span>(T:) </span> <input id = 's1_T' class = 's1_input' type = 'number' min = '0' max = '500' data = 'T'></input> (K) </div>
                </div>
              </div>
            </div>
          </div>

          <div class = 'col-md-6'>
            <div class = 'card'>
              <div class = 'card-header'>State 2</div>
              <div class = 'card-body text-justify'>
                <div style = 'margin-left: 10%'>
                  <div> <span>(p:) </span> <input id = 's2_p' class = 's2_input' type = 'number' min = '0' max = '300' data = 'p'></input> (kPa) </div>
                  <div class = 'my-2'> <span>(v:) </span> <input id = 's2_v' class = 's2_input' type = 'number' min = '0' max = '1' step = '0.01' data = 'v'></input> (kg/m^3) </div>
                  <div> <span>(T:) </span> <input id = 's2_T' class = 's2_input' type = 'number' min = '0' max = '500' data = 'T'></input> (K) </div>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>

    </div>
  </div>
</body>

<script>

Array.prototype.last = function(){ return this[ this.length-1 ]; }

var num_Points = 200;
var lineGen = d3.line().x(function(d){ return d.x }).y(function(d){ return d.y });

/*******************************************************************************************/

var R_air = 287, Î³_air = 1.4;
var ambient = { p: 100, T: 300 };
ambient.v = getVolume(ambient.p, ambient.T);

var state_1 = { p: ambient.p, v: ambient.v, T: ambient.T };
var state_2 = {};

var process = 'Adiabatic';
var new_state = { p: 200 };
var process_1_2_states = [];

/*******************************************************************************************/

function compute(){
  process_1_2_states = [];
  if(process == 'Adiabatic'){ process_1_2_states = adiabaticProcess(state_1, new_state); }

  state_2.p = process_1_2_states.last().p;
  state_2.v = process_1_2_states.last().v;
  state_2.T = process_1_2_states.last().T;
}

$(document).ready(function(){
  d3.selectAll('.s1_input').on('change', function(){
    state_1[ d3.select(this).attr('data') ] = this.value;
    compute(); updateInputs(); updateGraph();
  })

  d3.selectAll('.s2_input').on('change', function(){
    new_state = {};
    new_state[ d3.select(this).attr('data') ] = this.value;
    compute(); updateInputs(); updateGraph();
  })

  compute(); updateInputs(); createGraph();
})

function updateInputs(){
  document.getElementById('s1_p').value = state_1.p;
  document.getElementById('s1_v').value = state_1.v;
  document.getElementById('s1_T').value = state_1.T;

  document.getElementById('s2_p').value = state_2.p;
  document.getElementById('s2_v').value = state_2.v;
  document.getElementById('s2_T').value = state_2.T;
}

</script>
